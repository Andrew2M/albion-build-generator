(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(o){if(o.ep)return;o.ep=!0;const c=s(o);fetch(o.href,c)}})();const I=e=>{const t={};for(let s in e)e[s].forEach(n=>{t[n.category]?t[n.category]+=1:t[n.category]=1});return t},d={initState:{},current:{},qty:{},isRunning:!1,activeFilter:"",activeCategory:"",weaponType:!0,beforeBlock:{}},D=()=>d.beforeBlock,U=e=>{d.beforeBlock=e},x=()=>d.qty,S=()=>d.initState,V=()=>d.activeFilter,F=e=>{d.activeFilter=e},X=()=>d.isRunning,k=e=>{d.isRunning=e},l=()=>d.current,y=e=>{console.log(d.activeCategory),d.current={...d.current,...e}},Y=e=>{d.initState=e,d.qty=I(e)},Z=function(){const e=document.getElementById("filter-menu__title"),t=e.innerText,s=this.style.backgroundColor;this.style.backgroundColor="#008000",localStorage.setItem("customFilter",JSON.stringify(l())),e.innerText="Saved Filter Options",e.classList.add("heading--confirmed"),setTimeout(()=>{e.innerText=t,this.style.backgroundColor=s,e.classList.remove("heading--confirmed")},2e3)},g=({htmlElement:e,itemDataObj:t})=>{if(t){if(e.title=t.name,e.children[0].classList.add("hidden"),e.classList.remove("hidden"),t.require=="2H"){const s=document.querySelector(".offhand-slot");s.children[0].classList.add("hidden"),s.classList.remove("hidden")}}else e.children[0].classList.add("hidden")},h=(e,t,s=250)=>(e.dataset.state&&(s=0),new Promise((n,o)=>{setTimeout(()=>{n({htmlElement:e,itemDataObj:t})},s)}));function w(e){return Math.floor(Math.random()*e)}const p=(e,t)=>{if(e.dataset.state||!t.length)return;const s=t[w(t.length)];e.dataset.type=s.require;const n=`https://render.albiononline.com/v1/item/T${w(5)+4}_${s.image}.png`;if(e.style.backgroundImage=`url(${n})`,s.require==="2H"){const o=document.querySelectorAll(".item-slot")[4];o.style.backgroundImage=`url(${n})`,o.title=e.name}return s},q=()=>H(l()),M=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle");e.removeEventListener("click",E),t.removeEventListener("click",q),e.classList.remove("btn--success"),e.classList.add("btn--danger"),t.classList.remove("btn--success"),t.classList.add("btn--danger")},ee=({weapon:e,offhand:t,helmet:s,armor:n,shoe:o,cape:c})=>{const i=document.querySelector(".helmet-slot"),a=document.querySelector(".armor-slot"),m=document.querySelector(".shoe-slot"),b=document.querySelector(".main-hand-slot"),B=document.querySelector(".offhand-slot"),J=document.querySelector(".cape-slot"),u=document.querySelectorAll(".item-slot"),O=document.getElementById("generate").children[0];O.classList.add("spin"),k(!0),f(),M(),u.forEach(r=>{r.dataset.state||r.children[0].classList.remove("hidden")});const G=p(i,s),Q=p(a,n),K=p(m,o),W=p(J,c),T=p(b,e),z=b.dataset.type==="1H"?p(B,t):null;B.style.opacity="1",b.dataset.type=="2H"&&b.dataset.state&&(B.style.opacity="0.4"),h(u[5],W,400).then(r=>(g(r),h(u[0],G))).then(r=>(g(r),h(u[1],Q))).then(r=>(g(r),h(u[2],K))).then(r=>(g(r),h(u[3],T))).then(r=>(g(r),O.classList.remove("spin"),u[3].dataset.type=="1H"?(u[4].style.opacity="1",h(u[4],z)):(u[4].style.opacity="0.4",h(u[4],T)))).then(r=>{k(!1),f(),g(r)}).catch(r=>{console.error(r)})},E=()=>ee(l()),f=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle"),{weapon:s,offhand:n,helmet:o,armor:c,shoe:i,cape:a}=l();s.length&&n.length&&o.length&&c.length&&i.length&&a.length?(e.addEventListener("click",E),t.addEventListener("click",q),X()||(e.classList="btn__theme btn--success",t.classList="btn__theme btn--success")):(e.removeEventListener("click",E),t.removeEventListener("click",q),e.classList="btn__theme btn--danger",t.classList="btn__theme btn--danger")};function L(e){let t=e.length,s,n;for(;t;)n=Math.floor(Math.random()*t--),s=e[t],e[t]=e[n],e[n]=s;return e}function H({weapon:e,offhand:t,helmet:s,armor:n,shoe:o,cape:c}){k(!0),f(),M();const i=document.querySelectorAll(".item-slot");document.querySelectorAll(".image-slot").forEach(m=>m.classList.add("hidden")),i.forEach(m=>m.children[0].classList.remove("hidden")),L(s),L(n),L(o),L(e),L(t),L(c),setTimeout(()=>{k(!1),f(),i.forEach(m=>m.children[0].classList.add("hidden"))},750)}const R=()=>{const e=document.querySelectorAll(".filter-options__form");F(""),e.forEach(s=>{s.dataset.status=="checked"?s.classList.remove("remove"):s.classList.add("remove")}),document.querySelector(".filter-options__container").classList.toggle("open__vertical")},v=()=>{const e=document.getElementById("notification"),t=l();let s=[];for(let o in t)t[o].length==0&&s.push(o);const n=s.map((o,c)=>s.length>=2&&c===s.length-1?`and <span class="category">${o}</span>`:`<span class="category">${o}</span>`);e.innerHTML=s.length?`Open <span id="link">Filter Options</span> and select at least one ${n.join(", ").split(", and").join(" and")} mastery!`:"",s.length?(e.style="visibility: visible;",document.getElementById("link").addEventListener("click",R)):e.style="visibility: hidden;"},C=e=>{e.innerText=="0"?(e.classList.add("text--danger"),e.classList.remove("text--success")):(e.classList.remove("text--danger"),e.classList.add("text--success"))},A=()=>{const e=document.querySelectorAll(".item-type__stats"),t=I(l());[...e].forEach(n=>{const o=n.children[0];o.innerText=`${t[n.dataset.mastery]||"0"}`,C(o),n.children[1].innerText=` / ${x()[n.dataset.mastery]}`});const s=[];for(let n in l())l()[n].forEach(o=>{s.includes(o.category)||s.push(o.category)})},N=e=>{const t={};return e?(U(l().weapon),t.weapon=l().weapon.filter(s=>s.require=="1H")):t.weapon=D(),t},$=function(){const e=this.parentElement.parentElement;if(console.log(e.dataset.slot),e.dataset.state){if(e.dataset.state)if(e.dataset.type==="2H"){const t=document.querySelector(".offhand-slot");delete e.dataset.state,delete t.dataset.state,t.children[1].classList.add("hidden"),t.children[1].children[0].addEventListener("click",$),e.children[1].style.opacity=1,e.children[1].classList.add("hidden")}else delete e.dataset.state,e.children[1].classList.add("hidden")}else if(e.dataset.type==="2H"){e.dataset.state="blocked",e.children[1].style.opacity=1,e.children[1].classList.remove("hidden");const t=document.querySelector(".offhand-slot");t.dataset.state="blocked",t.children[1].classList.remove("hidden"),t.children[1].children[0].removeEventListener("click",$)}else e.dataset.state="blocked",e.children[1].style.opacity=1,e.children[1].classList.remove("hidden");e.dataset.slot==="offhand"&&(y(N(e.dataset.state)),A())},te=function(){!this.dataset.state&&this.style.backgroundImage&&(this.children[1].style.opacity=.65,this.children[1].classList.remove("hidden"))},se=function(){!this.dataset.state&&this.style.backgroundImage&&this.children[1].classList.add("hidden")},ne=function(){const e=document.querySelector(".filter-options__container"),t=document.querySelector(".test");t.classList.add("hidden"),t.innerHTML="",document.querySelectorAll(".filter-options__form").forEach(o=>o.classList.add("remove")),V()!==this.dataset.slot?(e.classList.add("open__vertical"),F(this.dataset.slot)):(e.classList.remove("open__vertical"),F("")),document.querySelector(`.filter-options__form[data-slot="${this.dataset.slot}"]`).classList.remove("remove")};const _=e=>{if(e.dataset.slot){const t=l()[e.dataset.slot].length,s=document.querySelector(`.filter-icon[data-slot='${e.dataset.slot}']`),n=document.querySelector(`.filter-options__form[data-slot='${e.dataset.slot}']`);t?t>0&&(n.classList.add("filter-options--success"),n.classList.remove("filter-options--danger"),n.dataset.status="unchecked",s.classList.remove("btn--danger")):(n.classList.remove("filter-options--success"),n.classList.add("filter-options--danger"),n.dataset.status="checked",s.classList.add("btn--danger")),f()}},oe=()=>{const e=document.querySelectorAll(".item-type"),t=document.querySelectorAll(".item-type__stats"),s=document.querySelectorAll(".filter-options__form"),n=I(l());[...t].forEach(c=>{const i=c.children[0];i.innerText=`${n[c.dataset.mastery]||"0"}`,C(i),c.children[1].innerText=` / ${x()[c.dataset.mastery]}`});const o=[];for(let c in l())l()[c].forEach(i=>{o.includes(i.category)||o.push(i.category)});e.forEach(c=>{o.includes(c.name)&&(c.checked=!0)}),s.forEach(c=>_(c))},ce=e=>{const t={};if(e.classList.contains("select__all")){const n=S()[e.dataset.slot].filter(c=>c.category===e.dataset.category),o=l()[e.dataset.slot].filter(c=>c.category!==e.dataset.category);t[e.dataset.slot]=[...o,...n]}else if(e.classList.contains("select__none")){const n=l()[e.dataset.slot].filter(o=>o.category!==e.dataset.category);t[e.dataset.slot]=n}y(t);const s=document.querySelector(".offhand-slot");console.log("state: ",s),console.log("state: ",s.dataset.state),s.dataset.state&&(y(N(s.dataset.state)),A())},j=e=>{if(e.classList.contains("btn__select")||e.classList.contains("single-item")){const t=document.querySelector(`.item-type__stats[data-mastery='${e.dataset.category}']`),s=I(l()),n=t.children[0];n.innerText=`${s[e.dataset.category]||0}`,C(n)}},ie=function({target:e}){const t=document.querySelector(".notification__confirmation");let s=[...l()[e.dataset.slot]];this.checked?this.checked&&(l()[e.dataset.slot]=[...s,...S()[e.dataset.slot].filter(n=>n.id===e.id)]):(l()[e.dataset.slot]=s.filter(n=>n.id!==e.id),y(l())),t.innerText=`${e.name}${this.checked?" added":" removed"}`,t.classList.remove("hidden"),f(),_(e),j(e),v()},P=function(e){const t=document.querySelector(".test");if(document.querySelectorAll("label").forEach(n=>n.classList.remove("label--selected")),e.classList.contains("label__more")||e.classList.contains("btn__select")||e.classList.contains("btn__filter")){console.log(e);const n=S()[e.dataset.slot].filter(a=>a.category===e.dataset.category);if(!n.length)return;e.classList.add("label--selected");const o=l()[e.dataset.slot].map(a=>a.id),c=n.map(a=>`
  <div class="item-type__container">
    <input data-slot="${a.type}" class="${a.type} item-type single-item" type="checkbox" name="${a.name}" id="${a.id}" data-category="${a.category}"/>
    <label class="mastery__label" for="${a.id}">
    <img width="120" height="120" title="${a.name}" class="mastery__img" src="https://render.albiononline.com/v1/item/T8_${a.image}.png" />
    </label>
  </div>
  `).join("");t.innerHTML=c,document.querySelectorAll(".single-item").forEach(a=>{a.onclick=ie,o.includes(a.id)&&(a.checked=!0)}),e.classList.contains("label__more")&&t.classList.remove("hidden")}},le=({target:e})=>{ce(e),j(e),P(e),_(e),f(),v()},ae=function({target:e}){if(this.classList.contains("btn__filter-none")){const t={},s=document.querySelector(".test"),n=document.querySelector(".notification__confirmation");n.innerText=" ",s.classList.add("hidden"),t[this.dataset.slot]=[],y(t),f(),v(),_(e),A()}},re=function({target:e}){if(e.classList.contains("btn__filter-all")){const t={};t[e.dataset.slot]=S()[e.dataset.slot],console.log(t);const s=document.querySelector(".test"),n=document.querySelector(".notification__confirmation");s.classList.add("hidden"),n.innerText="",y(t),f(),P(e),v(),_(e),A()}},de=document.getElementById("generate"),ue=document.getElementById("shuffle"),fe=document.getElementById("save-config"),me=document.querySelectorAll(".item-slot"),he=document.querySelectorAll(".filter-icon"),ye=document.querySelectorAll(".lock-icon"),ge=document.getElementById("close"),pe=async()=>{const t=await(await fetch("./items.json")).json();Y({...t});const s=JSON.parse(localStorage.getItem("customFilter"));y(s||S()),oe(),H(s||S()),v(),ue.addEventListener("click",q),de.addEventListener("click",E),document.getElementById("filter-menu").addEventListener("click",le),document.querySelectorAll(".btn__filter-none").forEach(i=>i.addEventListener("click",ae)),document.querySelectorAll(".btn__filter-all").forEach(i=>i.addEventListener("click",re)),he.forEach(i=>i.addEventListener("click",ne,!0)),fe.addEventListener("click",Z),me.forEach(i=>{i.addEventListener("mouseover",te),i.addEventListener("mouseout",se)}),ye.forEach(i=>{i.addEventListener("click",$)}),ge.addEventListener("click",R)};document.addEventListener("DOMContentLoaded",pe);
