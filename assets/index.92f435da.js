(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=s(n);fetch(n.href,c)}})();const F=e=>{const t={};for(let s in e)e[s].forEach(o=>{t[o.category]?t[o.category]+=1:t[o.category]=1});return t},r={initState:{},current:{},qty:{},isRunning:!1,activeFilter:"",activeCategory:"",activeSlot:"",beforeBlock:[]},V=()=>r.beforeBlock,X=e=>{r.beforeBlock=e},M=()=>r.qty,y=()=>r.initState,b=()=>r.activeFilter,q=e=>{r.activeFilter=e},Y=()=>r.activeSlot,Z=e=>{r.activeSlot=e},N=()=>r.activeCategory,ee=e=>{r.activeCategory=e},te=()=>r.isRunning,E=e=>{r.isRunning=e},l=()=>r.current,g=e=>{r.current={...r.current,...e}},se=e=>{r.initState=e,r.qty=F(e)},ne=function(){const e=document.getElementById("filter-menu__title"),t=e.innerText,s=this.style.backgroundColor;this.style.backgroundColor="#008000",localStorage.setItem("customFilter",JSON.stringify(l())),e.innerText="Saved Filter Options",e.classList.add("heading--confirmed"),setTimeout(()=>{e.innerText=t,this.style.backgroundColor=s,e.classList.remove("heading--confirmed")},2e3)},L=({htmlElement:e,itemDataObj:t})=>{if(t){if(e.title=t.name,e.children[0].classList.add("hidden"),e.classList.remove("hidden"),t.require=="2H"){const s=document.querySelector(".offhand-slot");s.children[0].classList.add("hidden"),s.classList.remove("hidden")}}else e.children[0].classList.add("hidden")},h=(e,t,s=250)=>(e.dataset.state&&(s=0),new Promise((o,n)=>{setTimeout(()=>{o({htmlElement:e,itemDataObj:t})},s)}));function x(e){return Math.floor(Math.random()*e)}const v=(e,t)=>{if(e.dataset.state||!t.length)return;const s=t[x(t.length)];e.dataset.type=s.require;const o=`https://render.albiononline.com/v1/item/T${x(5)+4}_${s.image}.png`;e.style.backgroundImage=`url(${o})`;const n=document.querySelectorAll(".item-slot")[4];return s.require==="2H"&&(n.style.backgroundImage=`url(${o})`,n.title=e.name),s.require==="2H"?n.children[1].classList.add("remove"):n.children[1].classList.remove("remove"),s},I=()=>j(l()),R=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle");e.removeEventListener("click",A),t.removeEventListener("click",I),e.classList.remove("btn--success"),e.classList.add("btn--danger"),t.classList.remove("btn--success"),t.classList.add("btn--danger")},oe=({weapon:e,offhand:t,helmet:s,armor:o,shoe:n,cape:c})=>{const i=document.querySelector(".helmet-slot"),p=document.querySelector(".armor-slot"),m=document.querySelector(".shoe-slot"),a=document.querySelector(".main-hand-slot"),O=document.querySelector(".offhand-slot"),Q=document.querySelector(".cape-slot"),u=document.querySelectorAll(".item-slot"),H=document.getElementById("generate").children[0];H.classList.add("spin"),E(!0),f(),R(),u.forEach(d=>{d.dataset.state||d.children[0].classList.remove("hidden")});const K=v(i,s),W=v(p,o),z=v(m,n),D=v(Q,c),w=v(a,e),U=a.dataset.type==="1H"?v(O,t):null;O.style.opacity="1",a.dataset.type=="2H"&&a.dataset.state&&(O.style.opacity="0.4"),h(u[5],D,400).then(d=>(L(d),h(u[0],K))).then(d=>(L(d),h(u[1],W))).then(d=>(L(d),h(u[2],z))).then(d=>(L(d),h(u[3],w))).then(d=>(L(d),H.classList.remove("spin"),u[3].dataset.type=="1H"?(u[4].style.opacity="1",h(u[4],U)):(u[4].style.opacity="0.4",h(u[4],w)))).then(d=>{E(!1),f(),L(d)}).catch(d=>{console.error(d)})},A=()=>oe(l()),f=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle"),{weapon:s,offhand:o,helmet:n,armor:c,shoe:i,cape:p}=l();s.length&&o.length&&n.length&&c.length&&i.length&&p.length?(e.addEventListener("click",A),t.addEventListener("click",I),te()||(e.classList="btn__theme btn--success",t.classList="btn__theme btn--success")):(e.removeEventListener("click",A),t.removeEventListener("click",I),e.classList="btn__theme btn--danger",t.classList="btn__theme btn--danger")};function S(e){let t=e.length,s,o;for(;t;)o=Math.floor(Math.random()*t--),s=e[t],e[t]=e[o],e[o]=s;return e}function j({weapon:e,offhand:t,helmet:s,armor:o,shoe:n,cape:c}){E(!0),f(),R();const i=document.querySelectorAll(".item-slot");document.querySelectorAll(".image-slot").forEach(m=>m.classList.add("hidden")),i.forEach(m=>m.children[0].classList.remove("hidden")),S(s),S(o),S(n),S(e),S(t),S(c),setTimeout(()=>{E(!1),f(),i.forEach(m=>m.children[0].classList.add("hidden"))},750)}const P=()=>{const e=document.querySelectorAll(".filter-options__form");q(""),e.forEach(s=>{s.dataset.status=="checked"?s.classList.remove("remove"):s.classList.add("remove")}),document.querySelector(".filter-options__container").classList.toggle("open__vertical")},_=()=>{const e=document.getElementById("notification"),t=l();let s=[];for(let n in t)t[n].length==0&&s.push(n);const o=s.map((n,c)=>s.length>=2&&c===s.length-1?`and <span class="category">${n}</span>`:`<span class="category">${n}</span>`);e.innerHTML=s.length?`Open <span id="link">Filter Options</span> and select at least one ${o.join(", ").split(", and").join(" and")} mastery!`:"",s.length?(e.style="visibility: visible;",document.getElementById("link").addEventListener("click",P)):e.style="visibility: hidden;"},C=e=>{e.innerText=="0"?(e.classList.add("text--danger"),e.classList.remove("text--success")):(e.classList.remove("text--danger"),e.classList.add("text--success"))},J=e=>{if(e.classList.contains("btn__select")||e.classList.contains("single-item")){const t=document.querySelector(`.item-type__stats[data-mastery='${e.dataset.category}']`),s=F(l()),o=t.children[0];o.innerText=`${s[e.dataset.category]||0}`,C(o)}},k=e=>{if(e.dataset.slot){const t=l()[e.dataset.slot].length,s=document.querySelector(`.filter-icon[data-slot='${e.dataset.slot}']`),o=document.querySelector(`.filter-options__form[data-slot='${e.dataset.slot}']`),n=document.querySelector(`.btn__link[data-slot="${e.dataset.slot}"]`);t?t>0&&(o.classList.add("filter-options--success"),o.classList.remove("filter-options--danger"),o.dataset.status="unchecked",s.classList.remove("btn--danger"),n.classList.remove("btn__link--danger")):(o.classList.remove("filter-options--success"),o.classList.add("filter-options--danger"),o.dataset.status="checked",s.classList.add("btn--danger"),n.classList.add("btn__link--danger")),f()}};function ce({target:e}){const t=document.querySelector(".offhand-slot"),s=document.querySelector(".notification__confirmation");let o=[...l()[e.dataset.slot]];this.checked?this.checked&&(t.dataset.state&&this.dataset.require=="2H"?(l()[e.dataset.slot]=[...o,...y()[e.dataset.slot].filter(n=>n.id===e.id&&n.require=="1H")],this.checked=!1):l()[e.dataset.slot]=[...o,...y()[e.dataset.slot].filter(n=>n.id===e.id)]):t.dataset.state&&this.dataset.require=="2H"?this.checked=!1:(l()[e.dataset.slot]=o.filter(n=>n.id!==e.id),g(l())),t.dataset.state&&this.dataset.require=="2H"?s.innerText="This is not a one handed weapon":s.innerText=`${e.name}${this.checked?" added":" removed"}`,s.classList.remove("hidden"),f(),k(e),J(e),_()}const T=function(e){const t=document.querySelector(".test");if(document.querySelectorAll("label").forEach(o=>o.classList.remove("label--selected")),e.dataset.category||e.dataset.slot){const o=Y()||e.dataset.slot,n=N()||e.dataset.category,c=y()[o].filter(a=>a.category===n);if(!c.length)return;document.querySelector(`.label__more[data-category="${n}"]`).classList.add("label--selected");const i=l()[o].map(a=>a.id),p=c.map(a=>`
  <div class="item-type__container">
    <input data-slot="${a.type}" data-require="${a.require}" class="${a.type} item-type single-item" type="checkbox" name="${a.name}" id="${a.id}" data-category="${a.category}"/>
    <label class="mastery__label" for="${a.id}">
    <img width="120" height="120" title="${a.name}" class="mastery__img" src="https://render.albiononline.com/v1/item/T8_${a.image}.png" />
    </label>
  </div>
  `).join("");t.innerHTML=p,document.querySelectorAll(".single-item").forEach(a=>{i.includes(a.id)&&(a.checked=!0),a.onclick=ce}),t.classList.remove("hidden")}},$=()=>{const e=document.querySelectorAll(".item-type__stats"),t=F(l());[...e].forEach(o=>{const n=o.children[0];n.innerText=`${t[o.dataset.mastery]||"0"}`,C(n),o.children[1].innerText=` / ${M()[N()||o.dataset.mastery]}`});const s=[];for(let o in l())l()[o].forEach(n=>{s.includes(n.category)||s.push(n.category)})},G=(e=null)=>{const t={};return e?(X(l().weapon),t.weapon=l().weapon.filter(s=>s.require=="1H")):e||(t.weapon=V()),t},B=function(){const e=this.parentElement.parentElement;if(e.dataset.state){if(e.dataset.state)if(e.dataset.type==="2H"){const t=document.querySelector(".offhand-slot");delete e.dataset.state,delete t.dataset.state,t.children[1].children[0].addEventListener("click",B),e.children[1].style.opacity=1,e.children[1].classList.add("hidden")}else delete e.dataset.state,e.children[1].classList.add("hidden")}else if(e.dataset.type==="2H"){e.dataset.state="blocked",e.children[1].style.opacity=1,e.children[1].classList.remove("hidden");const t=document.querySelector(".offhand-slot");t.dataset.state="blocked",t.children[1].classList.add("remove"),t.children[1].children[0].removeEventListener("click",B)}else e.dataset.state="blocked",e.children[1].style.opacity=1,e.children[1].classList.remove("hidden");e.dataset.slot==="offhand"&&(console.log("blockItemSlot"),g(G(e.dataset.state)),$(),T(e))},ie=function(){!this.dataset.state&&this.style.backgroundImage&&(this.children[1].style.opacity=.65,this.children[1].classList.remove("hidden"))},le=function(){!this.dataset.state&&this.style.backgroundImage&&this.children[1].classList.add("hidden")},ae=function(){const e=document.querySelector(".filter-options__container"),t=document.querySelector(".test");t.classList.add("hidden"),t.innerHTML="",document.querySelectorAll(".filter-options__form").forEach(i=>i.classList.add("remove")),b()!==this.dataset.slot?(e.classList.add("open__vertical"),q(this.dataset.slot)):(e.classList.remove("open__vertical"),q(""));const o=document.querySelector(`.filter-options__form[data-slot="${this.dataset.slot}"]`);document.querySelectorAll(".btn__link").forEach(i=>i.classList="btn__link"),document.querySelector(`.btn__link[data-slot="${b()}"]`).classList.add("btn__link--selected"),o.classList.remove("remove")},re=({target:e})=>{if(e.classList.contains("btn__link")){const t=document.querySelectorAll(".filter-options__form"),s=document.querySelectorAll(".btn__link");t.forEach(c=>c.classList.add("remove")),s.forEach(c=>c.classList="btn__link"),q(e.dataset.slot);const o=document.querySelector(`.filter-options__form[data-slot="${b()}"]`),n=document.querySelector(`.btn__link[data-slot="${b()}"]`);o.classList.remove("remove"),n.classList.add("btn__link--selected")}},de=()=>{const e=document.querySelectorAll(".item-type"),t=document.querySelectorAll(".item-type__stats"),s=document.querySelectorAll(".filter-options__form"),o=F(l());[...t].forEach(c=>{const i=c.children[0];i.innerText=`${o[c.dataset.mastery]||"0"}`,C(i),c.children[1].innerText=` / ${M()[c.dataset.mastery]}`});const n=[];for(let c in l())l()[c].forEach(i=>{n.includes(i.category)||n.push(i.category)});e.forEach(c=>{n.includes(c.name)&&(c.checked=!0)}),s.forEach(c=>k(c))},ue=e=>{const t={};if(e.classList.contains("select__all")){const o=y()[e.dataset.slot].filter(c=>c.category===e.dataset.category),n=l()[e.dataset.slot].filter(c=>c.category!==e.dataset.category);t[e.dataset.slot]=[...n,...o]}else if(e.classList.contains("select__none")){const o=l()[e.dataset.slot].filter(n=>n.category!==e.dataset.category);t[e.dataset.slot]=o}g(t);const s=document.querySelector(".offhand-slot");s.dataset.state&&(g(G(s.dataset.state)),$())},fe=({target:e})=>{e.dataset.category&&ee(e.dataset.category),e.dataset.slot&&Z(e.dataset.slot),ue(e),J(e),T(e),k(e),f(),_()},me=function({target:e}){if(this.classList.contains("btn__filter-none")){const t={},s=document.querySelector(".test"),o=document.querySelector(".notification__confirmation");o.innerText="",s.classList.add("hidden"),t[this.dataset.slot]=[],g(t),f(),_(),k(e),$()}},he=function({target:e}){if(e.classList.contains("btn__filter-all")){const t={};t[e.dataset.slot]=y()[e.dataset.slot];const s=document.querySelector(".test"),o=document.querySelector(".notification__confirmation");s.classList.add("hidden"),o.innerText="",g(t),f(),_(),k(e),$(),T(e)}};const ye=document.getElementById("generate"),ge=document.getElementById("shuffle"),pe=document.getElementById("save-config"),Le=document.querySelectorAll(".item-slot"),ve=document.querySelectorAll(".filter-icon"),Se=document.querySelectorAll(".lock-icon"),_e=document.getElementById("close"),ke=document.querySelector(".filter-options__nav"),be=async()=>{const t=await(await fetch("./items.json")).json();se({...t});const s=JSON.parse(localStorage.getItem("customFilter"));g(s||y()),de(),j(s||y()),_(),ge.addEventListener("click",I),ye.addEventListener("click",A),document.getElementById("filter-menu").addEventListener("click",fe),ke.addEventListener("click",re),document.querySelectorAll(".btn__filter-none").forEach(i=>i.addEventListener("click",me)),document.querySelectorAll(".btn__filter-all").forEach(i=>i.addEventListener("click",he)),ve.forEach(i=>i.addEventListener("click",ae,!0)),pe.addEventListener("click",ne),Le.forEach(i=>{i.addEventListener("mouseover",ie),i.addEventListener("mouseout",le)}),Se.forEach(i=>{i.addEventListener("click",B)}),_e.addEventListener("click",P)};document.addEventListener("DOMContentLoaded",be);
