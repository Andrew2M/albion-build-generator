(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const $=e=>{const t={};for(let n in e)e[n].forEach(o=>{t[o.category]?t[o.category]+=1:t[o.category]=1});return t},r={initState:{},current:{},qty:{},isRunning:!1,activeFilter:"",activeCategory:"",activeSlot:"",beforeBlock:[]},D=()=>r.beforeBlock,ee=e=>{r.beforeBlock=e},N=()=>r.qty,_=()=>r.initState,k=()=>r.activeFilter,I=e=>{r.activeFilter=e},R=()=>r.activeSlot,P=e=>{r.activeSlot=e},Q=()=>r.activeCategory,te=e=>{r.activeCategory=e},se=()=>r.isRunning,A=e=>{r.isRunning=e},l=()=>r.current,p=e=>{r.current={...r.current,...e}},ne=e=>{r.initState=e,r.qty=$(e)},oe=function(){const e=document.getElementById("filter-menu__title"),t=e.innerText,n=this.style.backgroundColor;this.style.backgroundColor="#008000",localStorage.setItem("customFilter",JSON.stringify(l())),e.innerText="Saved Filter Options",e.classList.add("heading--confirmed"),setTimeout(()=>{e.innerText=t,this.style.backgroundColor=n,e.classList.remove("heading--confirmed")},2e3)},g=({htmlElement:e,itemDataObj:t})=>{if(t){const n=document.createElement("img");n.addEventListener("load",()=>{if(e.title=t.name,e.children[0].classList.add("hidden"),e.classList.remove("hidden"),t.require=="2H"){const o=document.querySelector(".offhand-slot");o.children[0].classList.add("hidden"),o.classList.remove("hidden")}n.remove()}),n.setAttribute("src",t.fullUrl)}else e.children[0].classList.add("hidden")},y=(e,t,n=300)=>(e.dataset.state&&(n=0),new Promise((o,s)=>{setTimeout(()=>{o({htmlElement:e,itemDataObj:t})},n)}));function x(e){return Math.floor(Math.random()*e)}const L=(e,t)=>{if(e.dataset.state||!t.length)return;const n=t[x(t.length)];e.dataset.type=n.require;const o=`https://render.albiononline.com/v1/item/T${x(5)+4}_${n.image}.png`;e.style.backgroundImage=`url(${o})`;const s=document.querySelectorAll(".item-slot")[4];return n.require==="2H"&&(s.style.backgroundImage=`url(${o})`,s.title=e.name),n.require==="2H"?s.children[1].classList.add("remove"):s.children[1].classList.remove("remove"),n.fullUrl=o,n},C=()=>J(l()),j=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle");e.removeEventListener("click",F),t.removeEventListener("click",C),e.classList.remove("btn--success"),e.classList.add("btn--danger"),t.classList.remove("btn--success"),t.classList.add("btn--danger")},ie=({weapon:e,offhand:t,helmet:n,armor:o,shoe:s,cape:i})=>{const c=document.querySelector(".helmet-slot"),u=document.querySelector(".armor-slot"),f=document.querySelector(".shoe-slot"),S=document.querySelector(".main-hand-slot"),a=document.querySelector(".offhand-slot"),W=document.querySelector(".cape-slot"),m=document.querySelectorAll(".item-slot"),w=document.getElementById("generate").children[0];w.classList.add("spin"),A(!0),h(),j(),m.forEach(d=>{d.dataset.state||d.children[0].classList.remove("hidden")});const z=L(c,n),V=L(u,o),X=L(f,s),Y=L(W,i),M=L(S,e),Z=S.dataset.type==="1H"?L(a,t):null;a.style.opacity="1",S.dataset.type=="2H"&&S.dataset.state&&(a.style.opacity="0.4"),y(m[5],Y).then(d=>(g(d),y(m[0],z))).then(d=>(g(d),y(m[1],V))).then(d=>(g(d),y(m[2],X))).then(d=>(g(d),y(m[3],M))).then(d=>(g(d),w.classList.remove("spin"),m[3].dataset.type=="1H"?(m[4].style.opacity="1",y(m[4],Z)):(m[4].style.opacity="0.4",y(m[4],M)))).then(d=>{A(!1),h(),g(d)}).catch(d=>{console.error(d)})},F=()=>ie(l()),h=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle"),{weapon:n,offhand:o,helmet:s,armor:i,shoe:c,cape:u}=l();n.length&&o.length&&s.length&&i.length&&c.length&&u.length?(e.addEventListener("click",F),t.addEventListener("click",C),se()||(e.classList="btn__theme btn--success",t.classList="btn__theme btn--success")):(e.removeEventListener("click",F),t.removeEventListener("click",C),e.classList="btn__theme btn--danger",t.classList="btn__theme btn--danger")};function v(e){let t=e.length,n,o;for(;t;)o=Math.floor(Math.random()*t--),n=e[t],e[t]=e[o],e[o]=n;return e}function J({weapon:e,offhand:t,helmet:n,armor:o,shoe:s,cape:i}){A(!0),h(),j();const c=document.querySelectorAll(".item-slot");document.querySelectorAll(".image-slot").forEach(f=>f.classList.add("hidden")),c.forEach(f=>f.children[0].classList.remove("hidden")),v(n),v(o),v(s),v(e),v(t),v(i),setTimeout(()=>{A(!1),h(),c.forEach(f=>f.children[0].classList.add("hidden"))},750)}const G=()=>{I("");const e=document.querySelector(".filter-options__container");document.querySelector(".filter-options__items").classList.add("hidden"),e.classList.toggle("open__vertical")},b=()=>{const e=document.getElementById("notification"),t=l();let n=[];for(let s in t)t[s].length==0&&n.push(s);const o=n.map((s,i)=>n.length>=2&&i===n.length-1?`and <span class="category">${s}</span>`:`<span class="category">${s}</span>`);e.innerHTML=n.length?`Open <span id="link">Filter Options</span> and select at least one ${o.join(", ").split(", and").join(" and")} mastery!`:"",n.length?(e.style="visibility: visible;",document.getElementById("link").addEventListener("click",G)):e.style="visibility: hidden;"},ce=document.querySelector(".filter-options__items");let E=[];const le=()=>{const e=N()[Q()];E.push(!0),e==E.length&&E.every(n=>n)&&(ce.children[0].remove(),E=[])},T=e=>{e.innerText=="0"?(e.classList.add("text--danger"),e.classList.remove("text--success")):(e.classList.remove("text--danger"),e.classList.add("text--success"))},K=e=>{if(e.classList.contains("btn__select")||e.classList.contains("single-item")){const t=document.querySelector(`.item-type__stats[data-mastery='${e.dataset.category}']`),n=$(l()),o=t.children[0];o.innerText=`${n[e.dataset.category]||0}`,T(o)}},q=e=>{if(e.dataset.slot){const t=l()[e.dataset.slot].length,n=document.querySelector(`.filter-icon[data-slot='${e.dataset.slot}']`),o=document.querySelector(`.filter-options__status[data-slot='${e.dataset.slot}']`),s=document.querySelector(`.filter-options__form[data-slot='${e.dataset.slot}']`),i=document.querySelector(`.btn__link[data-slot="${e.dataset.slot}"]`);t?t>0&&(s.classList.add("filter-options--success"),s.classList.remove("filter-options--danger"),s.dataset.status="checked",n.classList.remove("btn--danger"),i.classList.remove("btn__link--danger"),i.classList.add("btn__link--success"),o.classList="filter-options__status success"):(s.classList.remove("filter-options--success"),s.classList.add("filter-options--danger"),s.dataset.status="unchecked",n.classList.add("btn--danger"),i.classList.remove("btn__link--success"),i.classList.add("btn__link--danger"),o.classList="filter-options__status danger"),h()}};function ae({target:e}){const t=document.querySelector(".offhand-slot"),n=document.querySelector(".notification__confirmation");let o=[...l()[e.dataset.slot]];this.checked?this.checked&&(t.dataset.state&&this.dataset.require=="2H"?(l()[e.dataset.slot]=[...o,..._()[e.dataset.slot].filter(s=>s.id===e.id&&s.require=="1H")],this.checked=!1):l()[e.dataset.slot]=[...o,..._()[e.dataset.slot].filter(s=>s.id===e.id)]):t.dataset.state&&this.dataset.require=="2H"?this.checked=!1:(l()[e.dataset.slot]=o.filter(s=>s.id!==e.id),p(l())),t.dataset.state&&this.dataset.require=="2H"?n.innerText="This is not a one handed weapon":n.innerText=`${e.name}${this.checked?" added":" removed"}`,n.classList.remove("hidden"),h(),q(e),K(e),b()}const H=function(e){const t=document.querySelector(".filter-options__items");if(document.querySelectorAll("label").forEach(o=>o.classList.remove("label--selected")),e.classList.contains("label__more")||e.classList.contains("btn__select")||e.classList.contains("offhand-slot")){const o=R()||e.dataset.slot,s=Q()||e.dataset.category;e.classList.contains("offhand-slot")||t.classList.remove("hidden"),t.innerHTML='<div class="filter-options__loading"><div class="spinner"></div>/div>';const i=_()[o].filter(a=>a.category===s);if(!i.length)return;document.querySelector(`.label__more[data-category="${s}"]`).classList.add("label--selected");const c=l()[o].map(a=>a.id),u=i.map(a=>`
          <div class="item-type__container">
            <input data-slot="${a.type}" data-require="${a.require}" class="${a.type} item-type single-item" type="checkbox" name="${a.name}" id="${a.id}" data-category="${a.category}"/>
            <label class="mastery__label" for="${a.id}">
            <img width="120" height="120" title="${a.name}" class="mastery__img" src="https://render.albiononline.com/v1/item/T8_${a.image}.png" />
            </label>
          </div>
  `).join("");t.innerHTML+=u;const f=document.querySelectorAll(".single-item");document.querySelectorAll(".mastery__img").forEach(a=>a.addEventListener("load",le)),f.forEach(a=>{c.includes(a.id)&&(a.checked=!0),a.onclick=ae})}},B=()=>{const e=document.querySelectorAll(".item-type__stats"),t=$(l());[...e].forEach(o=>{const s=o.children[0];s.innerText=`${t[o.dataset.mastery]||"0"}`,T(s)});const n=[];for(let o in l())l()[o].forEach(s=>{n.includes(s.category)||n.push(s.category)})},U=(e=null)=>{const t={};return e?(ee(l().weapon),t.weapon=l().weapon.filter(n=>n.require=="1H")):e||(t.weapon=D()),t},O=function(){const e=this.parentElement.parentElement;if(e.dataset.state){if(e.dataset.state)if(e.dataset.type==="2H"){const t=document.querySelector(".offhand-slot");delete e.dataset.state,delete t.dataset.state,t.children[1].children[0].addEventListener("click",O),e.children[1].style.opacity=1,e.children[1].classList.add("hidden")}else delete e.dataset.state,e.children[1].classList.add("hidden")}else if(e.dataset.type==="2H"){e.dataset.state="blocked",e.children[1].style.opacity=1,e.children[1].classList.remove("hidden");const t=document.querySelector(".offhand-slot");t.dataset.state="blocked",t.children[1].classList.add("remove"),t.children[1].children[0].removeEventListener("click",O)}else e.dataset.state="blocked",e.children[1].style.opacity=1,e.children[1].classList.remove("hidden");e.dataset.slot==="offhand"&&(p(U(e.dataset.state)),B(),H(e))},re=function(){!this.dataset.state&&this.style.backgroundImage&&(this.children[1].style.opacity=.65,this.children[1].classList.remove("hidden"))},de=function(){!this.dataset.state&&this.style.backgroundImage&&this.children[1].classList.add("hidden")},ue=function(){const e=document.querySelector(".filter-options__container");document.querySelector(".filter-options__items").classList.add("hidden"),document.querySelectorAll(".filter-options__form").forEach(u=>u.classList.add("remove")),k()!==this.dataset.slot?(e.classList.add("open__vertical"),I(this.dataset.slot)):(e.classList.remove("open__vertical"),I(""));const o=document.querySelector(`.filter-options__form[data-slot="${this.dataset.slot}"]`);document.querySelectorAll(".btn__link").forEach(u=>u.classList="btn__link");const i=document.querySelector(`.btn__link[data-slot="${k()}"]`),c=l()[k()].length;c?c&&(i.classList="btn__link btn__link--success btn__link--selected"):i.classList="btn__link btn__link--danger btn__link--selected",o.classList.remove("remove")},fe=({target:e})=>{if(e.classList.contains("btn__link")){P(e.dataset.slot);const t=document.querySelectorAll(".filter-options__form"),n=document.querySelectorAll(".btn__link");document.querySelector(".filter-options__items").classList.add("hidden"),document.querySelector(".notification__confirmation").classList.add("hidden"),t.forEach(f=>f.classList.add("remove")),n.forEach(f=>f.classList="btn__link"),I(e.dataset.slot);const i=document.querySelector(`.filter-options__form[data-slot="${k()}"]`),c=document.querySelector(`.btn__link[data-slot="${k()}"]`);i.classList.remove("remove");const u=l()[R()||e.dataset.slot].length;u?u&&(c.classList="btn__link btn__link--success btn__link--selected"):c.classList="btn__link btn__link--danger btn__link--selected"}},me=()=>{const e=document.querySelectorAll(".item-type"),t=document.querySelectorAll(".item-type__stats"),n=document.querySelectorAll(".filter-options__form"),o=$(l());[...t].forEach(i=>{const c=i.children[0];c.innerText=`${o[i.dataset.mastery]||"0"}`,T(c),i.children[1].innerText=` / ${N()[i.dataset.mastery]}`});const s=[];for(let i in l())l()[i].forEach(c=>{s.includes(c.category)||s.push(c.category)});e.forEach(i=>{s.includes(i.name)&&(i.checked=!0)}),n.forEach(i=>q(i))},he=e=>{document.querySelector(".filter-options__items");const t={};if(e.classList.contains("select__all")){const o=_()[e.dataset.slot].filter(i=>i.category===e.dataset.category),s=l()[e.dataset.slot].filter(i=>i.category!==e.dataset.category);t[e.dataset.slot]=[...s,...o]}else if(e.classList.contains("select__none")){const o=l()[e.dataset.slot].filter(s=>s.category!==e.dataset.category);t[e.dataset.slot]=o}p(t);const n=document.querySelector(".offhand-slot");n.dataset.state&&(p(U(n.dataset.state)),B())},ye=({target:e})=>{e.dataset.category&&te(e.dataset.category),e.dataset.slot&&P(e.dataset.slot),he(e),K(e),H(e),q(e),h(),b()},_e=function({target:e}){if(this.classList.contains("btn__filter-none")){const t=document.querySelector(".notification__confirmation");document.querySelector(".filter-options__items").classList.add("hidden"),t.innerText="";const o={};o[this.dataset.slot]=[],p(o),h(),b(),q(e),B()}},pe=function({target:e}){if(e.classList.contains("btn__filter-all")){const t={};t[e.dataset.slot]=_()[e.dataset.slot];const n=document.querySelector(".filter-options__items");n.classList.add("hidden"),n.innerHTML="";const o=document.querySelector(".notification__confirmation");o.innerText="",p(t),h(),b(),q(e),B(),H(e)}};const ge=document.getElementById("generate"),Le=document.getElementById("shuffle"),ve=document.getElementById("save-config"),Se=document.querySelectorAll(".item-slot"),ke=document.querySelectorAll(".filter-icon"),be=document.querySelectorAll(".lock-icon"),qe=document.getElementById("close"),Ee=document.querySelector(".filter-options__nav"),Ie=async()=>{const t=await(await fetch("./items.json")).json();ne({...t});const n=JSON.parse(localStorage.getItem("customFilter"));p(n||_()),me(),J(n||_()),b(),Le.addEventListener("click",C),ge.addEventListener("click",F),document.getElementById("filter-menu").addEventListener("click",ye),Ee.addEventListener("click",fe),document.querySelectorAll(".btn__filter-none").forEach(c=>c.addEventListener("click",_e)),document.querySelectorAll(".btn__filter-all").forEach(c=>c.addEventListener("click",pe)),ke.forEach(c=>c.addEventListener("click",ue,!0)),ve.addEventListener("click",oe),Se.forEach(c=>{c.addEventListener("mouseover",re),c.addEventListener("mouseout",de)}),be.forEach(c=>{c.addEventListener("click",O)}),qe.addEventListener("click",G)};document.addEventListener("DOMContentLoaded",Ie);
