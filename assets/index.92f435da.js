(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const b=e=>{const t=document.querySelectorAll(".item-type"),s=document.querySelector(".offhand-slot");let i={};const o=[...t].filter(c=>c.checked).map(c=>c.name);for(let c in e)i[c]=e[c].filter(h=>o.includes(h.category));return s.dataset.state=="blocked"&&(i.weapon=i.weapon.filter(c=>c.type=="1H")),i},l={initState:{},current:{},qty:{},isRunning:!1},P=()=>l.qty,y=()=>l.initState,J=()=>l.isRunning,v=e=>{l.isRunning=e},S=()=>l.current,I=e=>{l.current={...e}},G=e=>{l.initState=e,l.qty.weapon=l.initState.weapon.length,l.qty.helmet=l.initState.helmet.length,l.qty.armor=l.initState.armor.length,l.qty.shoe=l.initState.shoe.length,l.qty.offhand=l.initState.offhand.length,l.qty.cape=l.initState.cape.length},O=()=>{const e=document.querySelector(".options__container"),t=document.getElementById("menu-btn");e.classList.toggle("open__vertical"),t.children[0].classList.toggle("turn")},w=()=>{const e=document.getElementById("notification"),t=S();let s=[];for(let n in t)t[n].length==0&&s.push(n);const i=s.map((n,o)=>s.length>=2&&o===s.length-1?`and <span class="category">${n}</span>`:`<span class="category">${n}</span>`);e.innerHTML=s.length?`Open <span id="link">Filter Options</span> and select at least one ${i.join(", ").split(", and").join(" and")} type!`:"",s.length?(e.style="visibility: visible;",document.getElementById("link").addEventListener("click",O)):e.style="visibility: hidden;"},m=({htmlElement:e,itemDataObj:t})=>{if(t){if(e.title=t.name,e.children[0].classList.add("hidden"),e.classList.remove("hidden"),t.type.length==2){const s=document.querySelector(".offhand-slot");s.children[0].classList.add("hidden"),s.classList.remove("hidden")}}else e.children[0].classList.add("hidden")},u=(e,t,s=250)=>(e.dataset.state&&(s=0),new Promise((i,n)=>{setTimeout(()=>{i({htmlElement:e,itemDataObj:t})},s)}));function H(e){return Math.floor(Math.random()*e)}const f=(e,t,s="")=>{if(e.dataset.state||!t.length)return;const i=t[H(t.length)];e.dataset.type=i.type;const n=`https://render.albiononline.com/v1/item/T${H(5)+4}${s}_${i.image}.png`;if(e.style.backgroundImage=`url(${n})`,i.type==="2H"){const o=document.querySelectorAll(".item-slot")[4];o.style.backgroundImage=`url(${n})`,o.title=e.name}return i};function g(e){let t=e.length,s,i;for(;t;)i=Math.floor(Math.random()*t--),s=e[t],e[t]=e[i],e[i]=s;return e}function A({weapon:e,offhand:t,helmet:s,armor:i,shoe:n,cape:o}){v(!0),p(),R();const c=document.querySelectorAll(".item-slot");document.querySelectorAll(".image-slot").forEach(d=>d.classList.add("hidden")),c.forEach(d=>d.children[0].classList.remove("hidden")),g(s),g(i),g(n),g(e),g(t),g(o),setTimeout(()=>{v(!1),p(),c.forEach(d=>d.children[0].classList.add("hidden"))},750)}const k=()=>A(S()),R=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle");e.removeEventListener("click",q),t.removeEventListener("click",k),e.classList.remove("btn--success"),e.classList.add("btn--danger"),t.classList.remove("btn--success"),t.classList.add("btn--danger")},z=({weapon:e,offhand:t,helmet:s,armor:i,shoe:n,cape:o})=>{const c=document.querySelector(".helmet-slot"),h=document.querySelector(".armor-slot"),d=document.querySelector(".shoe-slot"),L=document.querySelector(".main-hand-slot"),E=document.querySelector(".offhand-slot"),T=document.querySelector(".cape-slot"),r=document.querySelectorAll(".item-slot"),B=document.getElementById("generate").children[0];B.classList.add("spin"),v(!0),p(),R(),r.forEach(a=>{a.dataset.state||a.children[0].classList.remove("hidden")});const F=f(c,s,"_HEAD"),N=f(h,i,"_ARMOR"),$=f(d,n,"_SHOES"),x=f(T,o),M=f(L,e),C=L.dataset.type==="1H"?f(E,t,"_OFF"):null;E.style.opacity="1",L.dataset.type=="2H"&&L.dataset.state&&(E.style.opacity="0.4"),u(r[5],x,400).then(a=>(m(a),u(r[0],F))).then(a=>(m(a),u(r[1],N))).then(a=>(m(a),u(r[2],$))).then(a=>(m(a),u(r[3],M))).then(a=>(m(a),B.classList.remove("spin"),r[3].dataset.type==="1H"?(r[4].style.opacity="1",u(r[4],C)):(r[4].style.opacity="0.4",u(r[4],M)))).then(a=>{v(!1),p(),m(a)}).catch(a=>{console.error(a)})},q=()=>z(S()),p=()=>{const e=document.getElementById("generate"),t=document.getElementById("shuffle"),{weapon:s,offhand:i,helmet:n,armor:o,shoe:c,cape:h}=S();s.length&&i.length&&n.length&&o.length&&c.length&&h.length?(e.addEventListener("click",q),t.addEventListener("click",k),J()||(e.classList="btn__theme btn--success",t.classList="btn__theme btn--success")):(e.removeEventListener("click",q),t.removeEventListener("click",k),e.classList="btn__theme btn--danger",t.classList="btn__theme btn--danger")},_=e=>{const t=S()[e.dataset.type].length;P()[e.dataset.type],document.getElementById("generate");const s=document.querySelector(`.options__form[data-type=${e.dataset.type}]`);t?(s.classList="options__form options--success",s.dataset.status="unchecked"):(s.classList="options__form options--danger",s.dataset.status="checked"),p()},Q=({target:e})=>{e.dataset.type&&(document.querySelectorAll(`.${e.dataset.type}`).forEach(t=>t.checked=e.dataset.state==="unchecked"),e.dataset.state=e.dataset.state==="checked"?"unchecked":"checked",e.dataset.state==="checked"?e.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 1024 1024"><path fill="currentColor" d="M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"/></svg>
    `:e.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 1024 1024"><path fill="currentColor" d="M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8Z"/><path fill="currentColor" d="M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8Z"/></svg>
  `,I(b(y())),_(e),w())},Y=function(){const e=document.getElementById("filter-menu__title"),t=e.innerText,s=this.style.backgroundColor;this.style.backgroundColor="#008000",localStorage.setItem("customFilter",JSON.stringify(S())),e.innerText="Saved Filter Options",e.classList.add("heading--confirmed"),setTimeout(()=>{e.innerText=t,this.style.backgroundColor=s,e.classList.remove("heading--confirmed")},2e3)},Z=e=>{const t=document.querySelectorAll(".item-type"),s=document.querySelectorAll(".options__form"),i=[];for(let n in e)e[n].forEach(o=>{i.includes(o.category)||i.push(o.category)});t.forEach(n=>{i.includes(n.name)&&(n.checked=!0)}),s.forEach(n=>_(n))},j=({target:e})=>{e.classList.contains("item-type")&&(I(b(y())),p(),w(),_(e))},K=function(){if(!this.dataset.state&&this.style.backgroundImage)if(this.dataset.type==="2H"){this.dataset.state="blocked",this.children[1].style.opacity=1,this.children[1].classList.remove("hidden");const e=document.querySelector(".offhand-slot");e.dataset.state="blocked"}else this.dataset.type&&(this.dataset.state="blocked",this.children[1].style.opacity=1,this.children[1].classList.remove("hidden"));else if(this.dataset.state)if(this.dataset.type==="2H"){const e=document.querySelector(".offhand-slot");delete this.dataset.state,delete e.dataset.state,this.children[1].style.opacity=1,this.children[1].classList.add("hidden")}else this.dataset.type&&(delete this.dataset.state,this.children[1].classList.add("hidden"));I(b(y()))},V=function(){!this.dataset.state&&this.style.backgroundImage&&(this.children[1].style.opacity=.65,this.children[1].classList.remove("hidden"))},W=function(){!this.dataset.state&&this.style.backgroundImage&&this.children[1].classList.add("hidden")},D=document.getElementById("generate"),U=document.getElementById("shuffle"),X=document.getElementById("menu-btn"),ee=document.getElementById("save-config"),te=document.querySelectorAll(".item-slot"),ne=async()=>{const t=await(await fetch("./items.json")).json();G({...t});const s=JSON.parse(localStorage.getItem("customFilter"));I(s||y()),Z(s||y()),A(s||y()),w(),U.addEventListener("click",k),D.addEventListener("click",q),document.getElementById("filter-menu").addEventListener("click",j);const n=document.querySelectorAll(".btn__filter");X.addEventListener("click",O),n.forEach(o=>o.addEventListener("click",Q)),ee.addEventListener("click",Y),te.forEach(o=>{o.addEventListener("click",K),o.addEventListener("mouseover",V),o.addEventListener("mouseout",W)})};document.addEventListener("DOMContentLoaded",ne);
